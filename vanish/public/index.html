<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Vanish</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="landing-page">
    <div class="brand">
      <div class="logo">V</div>
      <div>
        <div class="title">Vanish</div>
        <div class="subtitle">Memory Connect</div>
      </div>
    </div>
    <h2 id="welcome-text">Logging in...</h2>

    <div id="main-menu" class="menu-container">
        <button class="btn" onclick="selectMode('local_pvp')">Local PvP Game</button>
        <button class="btn" onclick="selectMode('local_ai')">Local AI Game</button>
        <button class="btn" onclick="selectMode('online_private')">Online Private Room</button>
        <button class="btn highlight-btn" onclick="selectMode('online_ladder')">Online Ladder</button>
    </div>

    <div id="sub-menu" class="menu-container hidden">
        <h3 id="mode-title">Settings</h3>
        
        <div class="option-group" id="ai-level-group" style="display: none;">
            <label>AI Level:</label>
            <select id="ai-level-select">
                <option value="easy">Easy</option>
                <option value="medium" selected>Medium</option>
                <option value="hard">Hard</option>
                <option value="expert">Expert</option>
            </select>
        </div>

        <div class="option-group">
            <label>Board Size:</label>
            <select id="board-size-select">
                <option value="3">3x3</option>
                <option value="9">9x9</option>
                <option value="15" selected>15x15</option>
            </select>
        </div>

        <div class="option-group">
            <label>Rules:</label>
            <select id="rule-set-select">
                <option value="nolimit">Standard</option>
                <option value="renju">Renju</option>
                <option value="swap2">Swap2</option>
            </select>
        </div>

        <div class="option-group">
            <label>Vanish:</label>
            <select id="vanish-timer-select">
                <option value="3000">3 Seconds</option>
                <option value="10000" selected>10 Seconds</option>
                <option value="3600000">Off</option>
            </select>
        </div>

        <div style="display: flex; flex-direction: column; gap: 10px; width: 100%; margin-top: 10px;">
            <button id="start-btn" class="btn highlight-btn" onclick="confirmStart()">Start Match</button>
            <button id="join-btn" class="btn highlight-btn hidden" onclick="joinPrivateRoom()">Join a Room</button>
            <button class="btn ghost" onclick="backToMainMenu()">Back</button>
        </div>
    </div>
</div>

<div id="game-page" class="hidden">
    <div id="game-top-bar">
        <button class="btn ghost" onclick="showLandingPage()">Quit</button>
        <div id="turnPill" class="pill">Turn: P1</div>
        <div id="timerP1" class="timer">00:30</div>
    </div>

    <div id="board-container">
        <div id="boardWrap" class="board-wrap">
            <div id="board" class="board"></div>
            <div id="overlay" class="overlay hidden">
              <div class="overlay-card">
                <div id="overlayTitle" class="overlay-title">Message</div>
                <div id="overlayBody" class="overlay-body" style="white-space: pre-wrap;">...</div>
                
                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px;">
                    <button id="overlayBtn" class="btn">New Game</button>
                    <button id="overlayBtn2" class="btn ghost hidden">Main Menu</button>
                </div>
                
              </div>
            </div>
        </div>
    </div>
    
    <div class="meter-box" style="margin: 10px;">
        <div class="meter-title">Mistakes</div>
        <div id="mistakeMeter" class="meter"></div>
    </div>
</div>

<div id="matchmaking-modal" class="modal-overlay hidden">
    <div class="modal-content">
        <h2 id="matchmaking-text">Searching for opponent...</h2>
        <div id="matchmaking-spinner" class="spinner"></div>
        <div id="matchmaking-actions" class="hidden" style="flex-direction: column; gap: 10px; margin-top: 20px;">
            <button class="btn" onclick="playAIWhileWaiting()">Play AI While Waiting</button>
            <button class="btn ghost" onclick="cancelMatchmaking()">Cancel Search</button>
        </div>
        <button id="matchmaking-cancel-initial" class="btn ghost" style="margin-top: 20px;" onclick="cancelMatchmaking()">Cancel</button>
    </div>
</div>

<div id="match-found-modal" class="modal-overlay hidden" style="z-index: 2000;">
    <div class="modal-content">
        <h2 style="color: #ffcf40;">Opponent Found!</h2>
        <p>Accept match and quit AI game?</p>
        <button class="btn" style="margin-bottom: 10px;" onclick="acceptOnlineMatch()">Accept Match</button>
        <button class="btn ghost" onclick="declineOnlineMatch()">Decline</button>
    </div>
</div>

<script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
<script src="rules.js"></script>
<script src="ai.js"></script>
<script src="main.js"></script>
</body>
</html>